# 模拟面试题

### 进程和线程的区别
1. 进程是资源分配的基本单位，而线程是调度的基本单位。
2. 一个进程可以拥有多个线程，线程可以访问其隶属进程的资源。

### 进程的状态
进程有三个状态：
1. 就绪：就绪 →  运行
2. 运行：运行 → 阻塞 / 运行 → 阻塞
3. 阻塞：阻塞 → 就绪

![](./img/进程状态.png)

### 常见的进程调度算法
1. 先来先去服务，按照进程的请求顺序去执行，利于长作业，不利于短作业
2. 短作业优先，先执行估计时间短的作业，利于短作业，不利于长作业
3. 时间片轮转，将所有就绪进程按先来先去的原则拍成一个队列，然后每次调度的时候，让队首进程执行一个时间片，执行完后把队首放到队尾。
4. 优先级调度，给每一个进程分配一个优先级，按优先级来进行调度
5. 多级反馈队列，可以理解为 时间片 + 优先级 的结合

### 进程之间怎么通信 (IPC)

1. 共享存储：在内存开辟一个共享空间，让其他进程可以在此读写。
   1. 基于共享数据结构的通信：通过固定的数据结构进行通信，比如长度固定为10的数组，不够灵活。
   2. 基于共享存储区的通信：在内存划出一块共享存储区，存储的数据格式、位置交给进程控制。通信方式灵活、速度快。
2. 管道通信：在内存开辟一个大小固定的缓冲区，作为两个进程的共享文件。一个进程负责去写，一个进程负责去读。
3. 消息传递：
   1. 直接通信方式：发送进程通过发送原语把消息发到到接收进程的消息缓冲队列，接收进程通过接收原语从消息缓冲队列里读取信息。
   2. 间接通信方式：在消息传递过程中多了一个中间实体“信箱”，发送进程把消息发给信箱，接收进程从信箱里读取信息。

### 线程之间怎么通信
读写同一进程中的的数据进行通信


### 进程同步
1. 临界区：通过多线程的串行话来访问公共资源，不过只能用来同步本进程里的线程。
2. 互斥量：和临界区有点类似，不过它可以用来实现跨进程的线程同步
3. 信号量：它允许多个线程在同一时刻去访问同一个资源，但是需要限制最大线程数目，如果这个数目为1，那么就和互斥量类似了


### 进程同步和进程通信的区别
进程同步：是控制多个进程按照一定顺序执行，是一种目的
进程通信：是进程之间信息的传递，是一种手段

往往为了达到进程同步，而需要使用进程通信。

### 什么是死锁
死锁，是多个进程在运行期间因为竞争资源而产生的一种僵局。

比如进程 A 想要一个资源，但这个资源正在被 B 所占用，而 B 也想要一个资源，但这个资源正在被 A 所占用，所以导致 A 和 B 都在等待对方用完占用资源主动释放。 

### 产生死锁的四个必要条件
1. 互斥：一个资源在同一时间只能被一个进程所使用
2. 占有和等待：一个进程因请求的资源被占用而等待时，对自己已拥有的资源保持不放
3. 不可抢占：进程不能抢占其他已被占用的资源
4. 环路等待：陷入死锁的进程会形成一条环路，该环路的进程都在等待其他进程所占用的资源

### 怎么解决死锁
#### 1. 鸵鸟策略
故名思意，就是不管它，因为死锁发生概率很低，一般不会对用户产生影响。

#### 2. 死锁检测 + 死锁恢复
死锁检测：在死锁里的进程和资源会形成一个环，我们可用从这个环的某一个节点开始去深度遍历，并打上标记，如果遍历到已经标记过的节点，就说明成环，也就是存在死锁

死锁恢复：
1. 让某一个进程去强制抢占它请求资源
2. 杀死环路里的某一个进程

#### 3. 死锁预防
**在程序运行之前**，预防死锁的发生。具体的话，就是破坏死锁的四个必备条件之一。

**比如破坏占有和等待条件，你可以规定一个进程在执行前，必须一次性成功请求到全部资源。**

#### 4. 死锁避免
**在程序运行的时候**，避免死锁发生。比如可以使用银行家算法，在系统分配资源时，先计算此次资源分配的安全性，若分配会导致系统进入不安全状态，则不分配，否则级分配。

### 虚拟内存的原理

虚拟内存，就是将实际上的物理内存，拓展成更大的逻辑内存空间，从而让程序可以使用更多的内存。

每一个程序拥有自己的逻辑内存地址，并对这些地址进行分页，当程序使用了一个不在物理内存中的页时，通过页面置换算法把该页置换到物理内存中。

### 常见的虚拟内存页面置换算法
1. 先进先出：根据进入的顺序先后来进行置换
2. 最久未使用：置换最久没有被用过的页
3. 最近最久未使用：将页维护成一个链表，一个页被访问了就放到链头，每次置换都置换链尾的页

### 分页和分段是什么？有什么区别？
- 目的不同：
	- 分页是虚拟内存使用的技术，目的是将物理内存抽象成更大的逻辑内存，属于系统需求
	- 分段是逻辑单位，它是一组具有完整意义的信息，目的是为了更好满足用户需求
- 长度不同：
	- 分页的长度是固定的，而且是系体指定的
	- 分段的长度是不固定，而且可以动态增长，取决于用户编写的程序
- 地址空间不同
	- 分页的地址空间是一维的
	- 分段的地址空间是二维的

### 读取磁盘的过程
1. 寻找合适扇区 → 旋转时间
2. 寻找合适的磁道 → 寻道时间
3. 数据传输时间

### 磁盘调度算法
寻道时间最长，磁盘调度算法调度的是寻道时间：
1. 先来先去 → 按照磁盘请求顺序进行调度
2. 最短寻道 → 优先调度距离磁头最近的磁道 → 两端容易饥饿
3. 电梯算法 → 先按一个方向寻找最近的磁道进行调度，直到该方向没有磁盘请求，然后改变方向
