# 吸顶效果
有两种方法实现吸顶效果
## 1. css
借助 position 的新特性 sticky。
```html
<head>
	<style type="text/css">
		.con {
			height: 600px;
			width: 600px;
			border: 1px solid #000;
			overflow: auto;
		}
		.top {
			height: 300px;
			background: #4e1;
		}
		.main {
			position: sticky;
			top: 0px;
			height: 50px;
			background: #f40;
		}
		.bottom {
			height: 1200px;
			background: #000;
		}
	</style>
</head>
<body>
	<div class="con">
		<div class="top"></div>
		<div class="main"></div>
		<div class="bottom"></div>
	</div>
</body>
```
sticky 是 css 新增的属性，可以说是相对定位 relative 和固定定位 fixed 的结合。

它主要用在对 scroll 事件的监听上，简单说在滑动过程中，某个元素的距离其父元素的距离达到 sticky 粘性定位要求时，position: sticky 这时的效果就相对于 fixed 定位，固定到适当的位置。

> sticky 的 fixed 和普通的 fixed 也不太一样。**普通的 fixed 是针对全局的，但 sticky 的 fixed 效果其实相对于它的父容器的**。

使用条件：
1. 父元素不能设置 overflow: hidden（overflow: auto 时也可能会让 sticky 失效）
2. 必须指定 top、bottom、left、right 4个值之一，否则只会处于相对定位
3. 父元素的高度不能低于 sticky 元素的高度
4. sticky 元素仅在其父元素内生效

## 2. js
```html
<head>
	<meta charset="utf-8">
	<title></title>
	<style type="text/css">
		* {
			padding: 0;
			margin: 0;
		}
		.top {
			height: 300px;
			background: #4e1;
			overflow: auto;
		}
		.main {
			/*position: sticky;
			top: 0;*/
			margin: 0 auto;
			width: 100%;
			height: 50px;
			background: #f40;
		}
		.test {
			position: fixed;
			top: 0;
		}
		.bottom {
			height: 1200px;
			background: #95f;
		}
	</style>
</head>
<body>
	<div class="top"></div>
	<div class="main"></div>
	<div class="bottom"></div>
</body>
<script>
let main = document.getElementsByClassName('main')[0];
let mainTop = main.offsetTop;
let mainHeight = main.clientHeight;
let bottom = document.getElementsByClassName('bottom')[0];
document.addEventListener('scroll', ()=> {
	if (document.documentElement.scrollTop >= mainTop) {
		main.classList.add('test');
		bottom.style.paddingTop = mainHeight + 'px';
	} else {
		main.classList.remove('test');
		bottom.style.paddingTop = 0;
	}
})
</script>
```
大体思路就是，监听页面滚动事件，然后根据页面滚动位置与导航栏初始位置的大小关系来添加 / 移除导航栏的 fixed 定位。

要实现 js 吸顶，我们要得到三个关键点：
1. 导航栏在父容器里的位置。可以借助导航栏的 offsetTop 属性获得，**但要注意** offsetTop 是元素相对于上一个定位元素的位置而不是父容器位置。
2. 父容器的滚动位置。可以通过父容器 scrollTop 属性获得。
3. 导航栏 fixed 定位位置。**但要注意** fixed 的定位是对 documentElement 的，而不是对父容器或上一个定位元素的。

因为 **offsetTop 和 fixed 都不是相对于父容器的**，所以很难实现普通滚动容器里的导航栏吸顶。但是可以实现全局页面的导航栏吸顶，因为对于 offsetTop、fixed 都可以是相对 documentElement 的。

而且要注意，通过 fixed 将导航栏固定后，导航栏会脱离原本的文档流，所以原本导航栏后面的布局就被打乱，需要做一下弥补操作来维持原本的布局。比如上例中我是用 paddingTop 去补齐了导航栏脱离文档流后的高度。

## 3. 对比
**fixed 定位是相对于 documentElement 的，所以一般 js 只给页面整体的导航栏添加吸顶效果。而 sticky 是相对于它的父元素的，所以可以更加灵活地给任意滚动容器添加吸顶导航栏。**

