# 构建民航业知识图谱并实现语义查询

「描述」对2011-2018年民航行业发展公报里的海量数据进行建模分析，并构建对应实体关系，将实体关系以动态知识图谱的形式可视化出来。

「成就」获得第九届“中国软件杯”全国一等奖

「职责」知识图谱 web 页面可视化

「项目亮点」封装了知识图谱svg的d3操作，并用 getter、setter 代理将其维护成一段响应式json数据，降低该项目的维护成本，减少其他小伙伴对 D3 的学习成本。

「技术要点」Vue、Svg、D3.js、

## 为什么能拿一等奖
首先说一下这个赛题，这个赛题的工作分两部分：
1. 数据挖掘成员，需要对民航业的实体关系进行建模分析，这部分不是我的工作
2. 对分析出来的实体关系以树状知识图谱的形式可视化出来，我这时我的工作

知识图谱的可视化可能并不难，有很库可以调，一两句代码可能就解决了。但是我的队友给我提出了一个新的需求——知识图谱的交互。

就是说，这个知识图谱上可以有很多的交互行为，比如：
1. 我鼠标悬浮到图谱某一个点，可以展示图谱的信息
2. 图谱的视图本身可以放大缩小
3. 我点击图谱一个点，就可以展示/隐藏它的全部子图谱

其中，最难的就是点击图谱上一个点之后去展示和隐藏它的子图谱。因为图谱展示起来是树状结构的，但它在 DOM 上不算树状结构的，每一个图谱的 DOM 节点在 DOM 结构上都是兄弟关系。但是，我现在要把它从逻辑上维护成类似树结构的一个东西。

怎么实现呢？我最后用了有点巧妙的方法。因为我绘制这个图谱的时候，需要从后台拿一份原始数据嘛，这份原始数据是一个 json 对象，我们知道 json 对象本身就是树结构的。所以，如果能把这个 json 数据和知识图谱的 DOM 结构联系起来，我就可以从用树的逻辑去处理知识图谱的 DOM 结构了。具体就是，双指针，就是给知识图谱上的 DOM 节点和其对应的 json 对象都添加一个相互指向的指针。

这样，我点击一个DOM 节点，就可以拿到它对应的 json 对象，然后也就可以拿到它子图谱上的点的 josn 对象，进而可以拿到子图谱上的点的 DOM 结构，去显示/隐藏它。

后来我有去对比同一个赛题下的其他参赛作品，发现大部分参数作品都可以实现知识图谱的可视化，但是很少有做到知识图谱的交互的，我想这也是我们的作品能拿一等奖的一部分原因。

## proxy 代理
这个 proxy 代理其实数据挖掘组那边有关师弟希望我做的。因为他后续可能想拿这份项目去做一些其他有关知识图谱方面的研究，又或者是类似的一些比赛吧。但他只会一点简单的 js 语法，也就是修改一些 json 对象之类的，不会 d3.js 对 svg 的一些操作，所以，我就给那份 json 做了一个 prxoy 代理，拦截了对于 json 对象的一些操作，比如给 json 对象添加一个子属性，子属性是另一个对象，那么对应的会用之前封装好的 d3.js 操作去绘制新的一个图谱节点。

我之所以想做这个，一方面是想练练 proxy 代理，因为 vue3.0 的响应式系统用 prxoy 代理实现的；另一方是想尝试一下造轮子的感觉。