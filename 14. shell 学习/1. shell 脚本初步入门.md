# 一、shell 脚本初步入门

## 1.1 什么是 shell
shell 是一个命令解释器，解释执行用户输入的命令及程序等。

> shell 的中文是贝壳，shell 命令解析器就像贝壳一样包住了系统核心。

## 1.2 什么是 shell 脚本
shell 命令解析器一般是用户输入一个命令，然后操作系统执行命令后返回一个响应到 shell，得到一种交互。

如果你想一次性执行多个命令、语句及循环控制，可以把这些放到 shell 脚本了一起执行。

所以，shell 脚本，就是命令、变量和流程控制语句的有机结合。

## 1.3 shell 脚本语言的种类
shell 脚本语言的优势，在于处理偏操作系统底层的业务。

在 Unix/Linux 种，主要有两大类 Shell：
- Bournce shell
- C shell

### 1.3.1 Bourne shell
Bourne shell 又包括以下三类：
- Bourne shell（sh）：标准的 UNIX Shell
- Korn shell（ksh）：sh 的超集，并且添加 csh 引入了新功能
- **Bourne Again shell（bash）：GUN 项目组开发，兼顾了对 sh 的兼容，是 Linux 发行的默认配置的 Shell，Linux 系统上的 /bin/sh 往往是指向 /bin/bash 的符号链接。**

> bash 和 sh 依旧存在不同：
	+ bash 拓展了一些命令和参数；
	+ bash 并不完全和 sh 兼容，它们有一些行为并不一致 

### 1.3.2 C shell
C shell 包括以下两类
- csh：csh 的流程控制语句很像 C 语言，支持很多 sh 不支持的功能
- tsch：csh 的增强版，加入了命令补全等功能，在 Mac OS x 等系统替代了 csh


## 1.4 常用操作性系统默认的 shell
window - cmd
Linux - bash
Mac - bash

## 1.5 shell 脚本的建立和执行
在 Linux 系统里，一般是使用 vi/vim 来编写 shell 脚本的。vim 是由 vi 发展过来的，功能比 vi 更加丰富。

### 1.5.1 vi/vim 的使用
vi/vim 有三种模式：
- 命令模式 (command mode)
	+ 刚启动 vi/vim 时，就会进入命令模式
	+ 命令模式下的输入的字符，会被处理成命令，而不是输入字符
	+ 常见的几个命令
		+ i → 切换到输入模式，以输入字符
		+ x → 删除当前光标所在处的字符
		+ : → 切换到底线命令模式，以在最底一行输入命令
- 输入模式  (insert mode)
	+ 在命令模式下输入 i 浸入输入模式
	+ 常见输入：
		+ 字符按键 + shift 组合 → 输入字符
		+ enter → 回车换行
		+ ESC → 退出输入模式，切换到命令模式
- 底线命令模式 (last line mode)
	+ 在命令模式下输入 : 就进入了底线命令模式
	+ 常见命令：
		+ :q → 退出程序
		+ :w → 保存文件 
		+ ESC → 退出底线命令模式

### 1.5.2 编写 shell 脚本
在 shell 脚本里，跟在 # 后面的内容一般表示注释，只有第一行比较特殊。

shell 脚本的第一行需要用 # 指明使用哪个程序（解释器）来执行脚本中的内容。

```bash
#! /bin/bash

echo "hello world"
```

> 在 Linux 里，sh 为 bash 的软链，所以在 shell 脚本首行写 `#! /bin/bash` 和 `#! /bin/sh` 是没有区别的，但是更规范的写法还是 `#! /bin/bash`。

shell 脚本编写规范：

1. shell 脚本的第一行是指定脚本解析器
2. shell 脚本的开头回加版本号、版权等信息
3. shell 脚本中尽量不用中文
4. shell 脚本的命名以 .sh 为拓展名
5. shell 脚本应该存放在固定的路径下

### 1.5.3 shell 脚本的执行

shell 脚本执行时，先会去查找系统环境变量 ENV，该变量指定了环境文件。加载到环境变量文件后，shell 就可以执行脚本内的代码。

shell 脚本的执行通常可以采用以下几种方式：

1. bash a.sh 或 sh a.sh：推荐的一般写法，以及脚本文件没有执行权，或脚本文件开头没有指明解释器时的用法

2. path/a.sh 或 ./a.sh：指定当前路径下的执行脚本，该脚本必须拥有可执行权限

3. source a.sh 或 . a.sh：执行 a.sh 的同时，可以将脚本中的变量值或函数返回值传递到当前父 shell 脚本。


