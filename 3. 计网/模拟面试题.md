# 模拟面试题

## 四、 计网

### 4.1 说一下 TCP 和 UDP 的区别
- TCP 是面向连接，提供可靠交付的一条点对点的全双工通道
- UDP 是无连接，尽最大努力交付，支持一对一、一对多、多对一和多对多的交互通信

### 4.2 说一下 TCP
TCP 是面向连接的，提供可靠交付的，建立一条点对点全双工通道进行的通信。

它通过三次握手建立连接，四次挥手断开连接。

另外，它通过滑动窗口协议来实现可靠传输和流量控制，通过“慢开始、拥塞避免、快重传、快恢复”四个算法来实现拥塞控制。

### 4.3 说一下 TCP 三次握手
1. 第一次握手：客户端发送一个 SYN=1，ACK = 0 的报文给服务端，表示请求建立连接
2. 第二次握手：如果服务端收到第一次握手的请求报文后，如果同意建立连接，返回一个 SYN=1，ACK=1 的响应报文
3. 第三次握手：客户端收到服务端的响应报文，还需要再给服务端发送一个 ACK=1 的确认报文。

第三次握手的目的，是为了防止已经失效的请求再次抵达服务端而产生错误。一个失效的连接请求发送到服务端，服务端依旧会返回一个确认给客户端。但因为这是一个失效请求的确认，所以客户端会无视它，不会发起第三次握手。服务端没有收到第三次握手，就明白刚刚的请求是失效的，不会建立连接。
### 4.4 说一下 TCP 四次挥手
1. 第一次握手：客户端发送一个 FIN=1 的报文，表示断开连接
2. 第二次握手：服务端收到客户端第一次挥手报文后，返回客户端一个确认，表示自己已经收到了请求，但是它还没准备好，可能还有一些其他的请求没处理完毕。
3. 第三次握手：服务端准备好断开连接了，就给客户端发送一个 FIN=1 的报文，表示断开连接
4. 第四次握手：客户端收到第三次握手的报文后，给服务端发送一个确认报文。服务端收到确认报文后，就可以释放连接了，但是客户端还需要等待 2MSL 的时间才断开连接。等待 2MSL 的目的是，确保第四次握手成功发送到服务端，以及处理服务端可能的对“已失效连接请求”的确认返回。

### 4.5 说一下 HTTP/1.1 和 HTTP/2.0 的区别
1. HTTP/2.0 的多路复用：
	- HTTP/1.1是串行共享一个 TCP 连接，上一个请求结束了，下一个的请求才会发起
	- HTTP/2.0 实行并行策略，多个请求可同时在一个 TCP 连接上并行执行，也叫多路复用
2. 数据流格式不一样：
	- HTTP/1.1 使用的是文本流
	- HTTP/2.0 使用的是二进制分帧，服务器解析起来会更快
3. 首部压缩
	- HTTP/1.1 首部不会压缩，每一次请求都需要发送一个新的首部
	- HTTP/2.0 在客户端和服务端之间维护一个首部字段表，这个首部字段表会包含之前出现过的首部字段，每次发起请求只会发送要更新的首部字段。另外，还使用了编码算法对首部进行压缩
4. 服务端推送
	- HTTP/1.1 不支持服务端推送
	- HTTP/2.0 支持服务端推送

### 4.6 说一下 HTTPS
HTTP 有三个缺点：
1. 明文传输 → 内容可能被窃听
2. 不验证通信双方 → 通信方可以伪造
3. 不验证报文完整性 → 报文可能被篡改

所以，提出了 HTTPS。

1. 加密：加密方式有两种，共享密钥加密和公开密钥加密。HTTPS 采取两者混合方式进行通信内容的加密。首先，通信双方先通过公钥加密传递一把共享密钥，然后后续的通信用这边共享密钥进行通信。
2. 验证通信双方：服务端的公钥需要提交给第三方权威机构进行认证，第三方机构会给公钥颁发证书，证书上有一个数字签名，这个签名用第三方机构私钥加密。服务端在给客户端发送公钥的时候把证书也发过去，客户端本地拥有第三方机构的公钥，可以认证证书上的数字签名的真实性，进而认同证书的权威性，也就相信了发送公钥的服务端。这个是客户端认证服务端。也存在客户端证书让服务端认证客户端，但是比较少，加格也昂贵。
3. 验证报文完整性：通过报文摘要来验证报文完整性。HTTP 也报文摘要，但因为它是明文传输，所以报文摘要也很容易进行篡改。HTTPS 因为加密导致报文摘要的成功篡改比较困难，进而可以保证报文完整性。

优点：能解决 HTTP 的三大缺点
缺点：因为需要对通信内容进行加密和解密，传输速度比 HTTP 慢；需要购买证书，需要一定成本。
		

### 4.7 说一下跨域
首先，跨域是什么？
跨域是因为浏览器的同源策略，导致 AJax 无法对非同源的资源进行请求。
同源的意思是：相同协议+相同域名+相同端口

然后，怎么解决？
第一，JSONP。
创建一个 script 标签插入文档，script 不受同源策略限制，会对它的 src 发起 get 请求，然后将响应数据传入指定的回调函数，我们从那个回调函数里获取 JSONP 跨域请求的响应。
优点是简单，而且不需要服务端做出修改。
缺点是只能发起 get 的跨域请求。

第二，CORS。
CORS 也叫跨域资源共享。一般是客户端发起请求的时候，在首部 Origin 字段告诉服务器自己的源，服务器判断该请求源是否在自己的允许跨域白名单里，如果在的话就同意跨域返回响应。另外对于一些特殊请求，比如发送 json 数据的 post 请求，浏览器会先发送一个 option 预检请求。

优点是：能够解决全部请求类型的跨域问题。
缺点是：不兼容一些较老的浏览器，而且需要服务端配置

第三，代理服务器
在本地搭建一个与页面同源的代理服务器，页面向代理服务器发送请求，代理服务器向真实服务器转发请求。常见的有 nodejs 代理服务器和 nginx 反向代理。

优点是：不需要服务端修改
缺点是：代理服务器搭建麻烦，不过可以结合一下脚手架工具来简化搭建工作